language: android
sudo: false

before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/

cache:
  directories:
    - "$HOME/.gradle/caches/"
    - "$HOME/.gradle/wrapper/"
    - "$HOME/.android/build-cache"

  env:
  global:
    # Change this values when updated
    - ANDROID_API=29
    - ANDROID_EMULATOR_API=22
    - ANDROID_BUILD_TOOLS=29.0.0
    - ANDROID_ABI=armeabi-v7a
    - secure: tmZAeuEUW/UL6wY/JWZmxdZy7Zb+KYgQNgxTv+YXS3ZSdc9PCa0ndnBQQ6XbfMPSTfisVfzjntCu0QQ0XKL8nyNTYq+HtEk5YJeH3BsZ0MLNDGMw00CXA9B845Hv2wOtQYftn1OyZ2rbY84mk0zN/dSwFkexVksJAUYQRMDjuREBKWXsYSAQTF8h8KmhALFzibbeJZMh+qpgGlUT3mrQeMzLmD9O1mJP8YKhg45iD6DtuDrQLRBfB9dJRmhpeNCTmUbU0tVc7t6Q4Wz4WiWiwEb/PDw+spnWm+sKS1prG5KzgiVysXaGklAb2IhDVTkRxtZ2TGidwmbIJHj1MmAW4GsBOb2Y6OYsIbV+dCHte7zMLC65XeVIhoaZfpSjT7nvNBfUqB2EldRhH6xZ6s/2LGGVzuUMEPXrvUFEKr4HA5P2y9LESwPBnG31ryHLR7723fdfH4tw3fFvl5enXheSzL1dkirHHxwaaDzEiURtEqAGSHfu+kmdAA9rUcuV7VJbqAWEI7l/kFthO9SuU/0kB+fXqNbTvHxwi13oxhLfkDQW2LIyAA/Adl/UCeORUbrr3TswxFtni7xNhL7DKsYCeYdmOir+e/+Ia2avxuCl8GqQMySFBa0Tr+IKWBeNy9W75dHTXPFMdCIbdIaGwk/GG8A9YOt2xtAC+L6oN+n4NvM=

  android:
  components:
  - tools
  - platform-tools
  - tools
  
  # The BuildTools version used by your project
  - build-tools-$ANDROID_BUILD_TOOLS
  
  # The SDK version used to compile your project
  - android-$ANDROID_API
  - android-$ANDROID_EMULATOR_API
  
  # For Google Maps API v1
  - addon-google_apis-google-$ANDROID_API
  
  # Google Play Services
  - extra-google-google_play_services
  
  # Support library
  - extra-android-support
  
  # Latest artifacts in local repository
  - extra-google-m2repository
  - extra-android-m2repository
  
  # Specify at least one system image,
    # if you need to run emulator(s) during your tests
  - sys-img-armeabi-v7a-android-$ANDROID_API
  - sys-img-armeabi-v7a-android-$ANDROID_EMULATOR_API

  before_script:
  - echo no | android create avd --force -n test -t android-$ANDROID_EMULATOR_API --abi $ANDROID_ABI
- emulator -avd test -no-skin -no-audio -no-window &
- android-wait-for-emulator
- adb shell input keyevent 82 &

before_install:
- yes | sdkmanager "platforms;android-29"
- - echo $encryptionPassword | gpg --passphrase-fd 0 .\\app\\google-services.json.gpg